<!DOCTYPE html>
<html lang="ko">
<head>
<title></title>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes, target-densitydpi=medium-dpi" name="viewport">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<link rel="stylesheet" type="text/css" href="css/default.css" />
<link rel="stylesheet" type="text/css" href="css/common.css" />
</head>

<body>

	<p class="hello"><span>HELLO WORLD!</span></p>

	<header id="header">
		<nav>
			<ul class="m1Dep">
				<li><a href="#html1">HTML</a>
					<ul class="m2Dep">
						<li><a href="#html1">마크업1</a></li>
						<li><a href="#html2">마크업2</a></li>
					</ul>
				</li>
				<li><a href="#css1">CSS</a>
					<ul class="m2Dep">
						<li><a href="#css1">너비에 비례하는 박스</a></li>
						<li><a href="#css2">말줄임</a></li>
						<li><a href="#css3">화살표</a></li>
					</ul>
				</li>
				<li><a href="#js1">JavaScript</a>
					<ul class="m2Dep">
						<li><a href="#js1">로또</a></li>
						<li><a href="#js2">풍선게임</a></li>
						<li><a href="#js3">bxSlider</a></li>
                        <li><a href="#js4">swiper</a></li>
					</ul>
				</li>
			</ul>
		</nav>
	</header>

	<section id="container">
		<section id="contents">
		</section>
	</section>

	<footer id="footer">
		<small>Copyright&copy;2016 By SEUNGKI. All right reserved.</small>
	</footer>

<div class="loading">
	<p></p>
</div>

<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/ui.js"></script>
<script type="text/javascript">
(function menu() {
	var menuWrap = $('header')
		,m1dep = menuWrap.find('.m1Dep > li > a')
		,m2dep = menuWrap.find('.m2Dep > li > a')
		,loading = $('.loading')
		,page,tit,snbTit,list;

	m1dep.bind('mouseenter', function(){
		var _this = $(this);
		$('.m2Dep').stop().slideUp(200);
		_this.next().stop().slideDown(200);
	});
	menuWrap.bind('mouseleave',function(){
		$('.m2Dep').stop().slideUp(200);
	});
	if (window.location.href.indexOf('#') > -1) { 
		var href = window.location.href;
		page = href.split('#')[1];

		var $this = $('.m2Dep > li > [href="#' + page + '"]');
		snbTit = $this.closest('li').find('> a').text();
		m2dep.parent().removeClass('current');
		$this.parent().addClass('current');

		tit = $this.text();
		list = $this.parent().parent().html();

		$.ajax({
			url : page+'.html',
			dataType: 'html',
			success : function(data){
                var subMenu = '<section id="snb"><h1 class="snbTit">'+snbTit+'</h1><nav><ul class="snbMenu">'+list+'</ul></nav></section>'
                $('#container').find('#snb').remove();
                $('#container').prepend(subMenu);
                $('#contents').html(data).prepend('<h1 class="pageTit">'+tit+'</h1>');
			}
		});
	}

	function pageLoad(page,tit,snbTit,list) {
		$.ajax({
			url : page+'.html',
			dataType: 'html',
			beforeSend : function() {
				loading.fadeIn().addClass('loadingOn').find('p').text(tit);
			},
			success : function(data){
				var subMenu = '<section id="snb"><h1 class="snbTit">'+snbTit+'</h1><nav><ul class="snbMenu">'+list+'</ul></nav></section>'
                $('#container').find('#snb').remove();
                $('#container').prepend(subMenu);
                $('#contents').html(data).prepend('<h1 class="pageTit">'+tit+'</h1>');
			},
			complete : function() {
				setTimeout(function(){
					loading.fadeOut(200,function(){
						$(this).removeClass('loadingOn');
					});
				},2000);
			}
		});
	}

	window.onhashchange = function(e){
		var href = window.location.href;
		page = href.split('#')[1];

		var $this = $('.m2Dep > li > [href="#' + page + '"]');
		snbTit = $this.parent().parent().prev().text();
		m2dep.parent().removeClass('current');
		$this.parent().addClass('current');
		
		tit = $this.text();
		list = $this.parent().parent().html();

		pageLoad(page,tit,snbTit,list);
	}

})()
</script>

</body>
</html>
